<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Brandon Sucrese" />


<title>DS 3606 :: Case Study 1</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About Me</a>
</li>
<li>
  <a href="BeerStudy.html">Beer Study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">DS 3606 :: Case Study 1</h1>
<h4 class="author">Brandon Sucrese</h4>
<h4 class="date">6/25/2021</h4>

</div>


<p>Introduction: Welcome to the brewery and beer analysis. The following code will walk through important discovers about beer. We will be looking at quantity of breweries and the distribution of beers’ alcohol content. We will also explore the relationship between alcohol content and bitterness as well as how the style of beer effects these variables. Lastly we will look into which states have the highest different in alcohol among their beers. Understanding how beer works and it’s finer details, always us to better understand beers in the future.</p>
<p>Code Summary: Reads in necessary libraries.</p>
<pre class="r"><code>library(naniar)</code></pre>
<pre><code>## Warning: package &#39;naniar&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## Warning: package &#39;tidyverse&#39; was built under R version 4.0.5</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.1.1     v dplyr   1.0.5
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.1</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Warning: package &#39;tibble&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Warning: package &#39;tidyr&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Warning: package &#39;readr&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Warning: package &#39;purrr&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 4.0.4</code></pre>
<pre><code>## Warning: package &#39;stringr&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Warning: package &#39;forcats&#39; was built under R version 4.0.4</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(mice)</code></pre>
<pre><code>## Warning: package &#39;mice&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<pre class="r"><code>library(ggplot2)
library(htmlwidgets)</code></pre>
<pre><code>## Warning: package &#39;htmlwidgets&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(caTools)</code></pre>
<pre><code>## Warning: package &#39;caTools&#39; was built under R version 4.0.5</code></pre>
<pre class="r"><code>library(class)
library(caret)</code></pre>
<pre><code>## Warning: package &#39;caret&#39; was built under R version 4.0.5</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre class="r"><code>library(stats)
library(dplyr)
library(agricolae)</code></pre>
<pre><code>## Warning: package &#39;agricolae&#39; was built under R version 4.0.5</code></pre>
<p>Code Summary: Reads in the beer and breweries data sets. Sets the variables to the correct type and summaries the two data sets.</p>
<pre class="r"><code>beer = read_csv(&quot;https://raw.githubusercontent.com/BivinSadler/MSDS_6306_Doing-Data-Science/Master/Unit%208%20and%209%20Case%20Study%201/Beers.csv&quot;) </code></pre>
<pre><code>## 
## -- Column specification --------------------------------------------------------
## cols(
##   Name = col_character(),
##   Beer_ID = col_double(),
##   ABV = col_double(),
##   IBU = col_double(),
##   Brewery_id = col_double(),
##   Style = col_character(),
##   Ounces = col_double()
## )</code></pre>
<pre class="r"><code>breweries = read.csv(&quot;https://raw.githubusercontent.com/BivinSadler/MSDS_6306_Doing-Data-Science/Master/Unit%208%20and%209%20Case%20Study%201/Breweries.csv&quot;)
breweries$State = as.factor(breweries$State)  ## Sets the state variable to a factor
summary(beer) ## Summarizes the beer data set</code></pre>
<pre><code>##      Name              Beer_ID            ABV               IBU        
##  Length:2410        Min.   :   1.0   Min.   :0.00100   Min.   :  4.00  
##  Class :character   1st Qu.: 808.2   1st Qu.:0.05000   1st Qu.: 21.00  
##  Mode  :character   Median :1453.5   Median :0.05600   Median : 35.00  
##                     Mean   :1431.1   Mean   :0.05977   Mean   : 42.71  
##                     3rd Qu.:2075.8   3rd Qu.:0.06700   3rd Qu.: 64.00  
##                     Max.   :2692.0   Max.   :0.12800   Max.   :138.00  
##                                      NA&#39;s   :62        NA&#39;s   :1005    
##    Brewery_id       Style               Ounces     
##  Min.   :  1.0   Length:2410        Min.   : 8.40  
##  1st Qu.: 94.0   Class :character   1st Qu.:12.00  
##  Median :206.0   Mode  :character   Median :12.00  
##  Mean   :232.7                      Mean   :13.59  
##  3rd Qu.:367.0                      3rd Qu.:16.00  
##  Max.   :558.0                      Max.   :32.00  
## </code></pre>
<pre class="r"><code>summary(breweries) ## Summarizes the breweries data set</code></pre>
<pre><code>##     Brew_ID          Name               City               State    
##  Min.   :  1.0   Length:558         Length:558          CO    : 47  
##  1st Qu.:140.2   Class :character   Class :character    CA    : 39  
##  Median :279.5   Mode  :character   Mode  :character    MI    : 32  
##  Mean   :279.5                                          OR    : 29  
##  3rd Qu.:418.8                                          TX    : 28  
##  Max.   :558.0                                          PA    : 25  
##                                                        (Other):358</code></pre>
<p>Code Summary: Plots the amount of breweries in each State.</p>
<pre class="r"><code>breweries %&gt;% ggplot(aes(x=reorder(State, State, function(x) -length(x)))) + geom_bar() + ggtitle(&quot;Breweries by State&quot;) + xlab(&quot;States&quot;)</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Code Summary: Merges the beer and breweries data set together and relabels the data set.</p>
<pre class="r"><code>beer_comp = merge(beer, breweries, by.x = &quot;Brewery_id&quot;, by.y = &quot;Brew_ID&quot;)  ## Merges the beer and breweries data sets
colnames(beer_comp)[which(names(beer_comp) == &quot;Name.x&quot;)] &lt;- &quot;Beer_Name&quot;  ## Renames column to Beer_Name
colnames(beer_comp)[which(names(beer_comp) == &quot;Name.y&quot;)] &lt;- &quot;Brewery_Name&quot;  ## Renames column to Brewery_Name
colnames(beer_comp)[which(names(beer_comp) == &quot;Brewery_id&quot;)] &lt;- &quot;Brewery_ID&quot;  ## Renames column to Brewery_ID</code></pre>
<p>Code Summary: Graphs missing data and shows first and last observations in the full beer data set.</p>
<pre class="r"><code>imp_beer_comp = beer_comp  ## Changes beer_comp to imp_beer_comp
gg_miss_var(imp_beer_comp)  ## Graphs missing values by variable</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>head(imp_beer_comp, n=10)  ## Displays first 10 observations</code></pre>
<pre><code>##    Brewery_ID      Beer_Name Beer_ID   ABV IBU
## 1           1   Get Together    2692 0.045  50
## 2           1  Maggie&#39;s Leap    2691 0.049  26
## 3           1     Wall&#39;s End    2690 0.048  19
## 4           1        Pumpion    2689 0.060  38
## 5           1     Stronghold    2688 0.060  25
## 6           1    Parapet ESB    2687 0.056  47
## 7           2 Citra Ass Down    2686 0.080  68
## 8           2 London Balling    2685 0.125  80
## 9           2           35 K    2684 0.077  25
## 10          2         A Beer    2683 0.042  42
##                                  Style Ounces              Brewery_Name
## 1                         American IPA     16        NorthGate Brewing 
## 2                   Milk / Sweet Stout     16        NorthGate Brewing 
## 3                    English Brown Ale     16        NorthGate Brewing 
## 4                          Pumpkin Ale     16        NorthGate Brewing 
## 5                      American Porter     16        NorthGate Brewing 
## 6  Extra Special / Strong Bitter (ESB)     16        NorthGate Brewing 
## 7       American Double / Imperial IPA     16 Against the Grain Brewery
## 8                   English Barleywine     16 Against the Grain Brewery
## 9                   Milk / Sweet Stout     16 Against the Grain Brewery
## 10             American Pale Ale (APA)     16 Against the Grain Brewery
##           City State
## 1  Minneapolis    MN
## 2  Minneapolis    MN
## 3  Minneapolis    MN
## 4  Minneapolis    MN
## 5  Minneapolis    MN
## 6  Minneapolis    MN
## 7   Louisville    KY
## 8   Louisville    KY
## 9   Louisville    KY
## 10  Louisville    KY</code></pre>
<pre class="r"><code>tail(imp_beer_comp, n=10)  ## Displays last 10 observations</code></pre>
<pre><code>##      Brewery_ID                    Beer_Name Beer_ID   ABV IBU
## 2401        552                 Ice Pick Ale     160 0.068  NA
## 2402        553      Mickey Finn&#39;s Amber Ale     174 0.056  NA
## 2403        554           Heiner Brau Kölsch     129 0.050  NA
## 2404        555 BrewFarm Select Golden Lager     110 0.055  NA
## 2405        556                Pilsner Ukiah      98 0.055  NA
## 2406        557     Heinnieweisse Weissebier      52 0.049  NA
## 2407        557              Snapperhead IPA      51 0.068  NA
## 2408        557            Moo Thunder Stout      50 0.049  NA
## 2409        557            Porkslap Pale Ale      49 0.043  NA
## 2410        558    Urban Wilderness Pale Ale      30 0.049  NA
##                         Style Ounces                  Brewery_Name
## 2401             American IPA     12             Silverton Brewery
## 2402 American Amber / Red Ale     12         Mickey Finn&#39;s Brewery
## 2403                   Kölsch     12           Covington Brewhouse
## 2404      American Pale Lager     12               Dave&#39;s Brewfarm
## 2405          German Pilsener     12         Ukiah Brewing Company
## 2406               Hefeweizen     12       Butternuts Beer and Ale
## 2407             American IPA     12       Butternuts Beer and Ale
## 2408       Milk / Sweet Stout     12       Butternuts Beer and Ale
## 2409  American Pale Ale (APA)     12       Butternuts Beer and Ale
## 2410         English Pale Ale     12 Sleeping Lady Brewing Company
##               City State
## 2401     Silverton    CO
## 2402  Libertyville    IL
## 2403     Covington    LA
## 2404        Wilson    WI
## 2405         Ukiah    CA
## 2406 Garrattsville    NY
## 2407 Garrattsville    NY
## 2408 Garrattsville    NY
## 2409 Garrattsville    NY
## 2410     Anchorage    AK</code></pre>
<p>Code Summary: Creates a new data set of Median ABV by state. Graphs and summarize this data set.</p>
<pre class="r"><code>State_ABV = imp_beer_comp %&gt;% filter(!is.na(imp_beer_comp$ABV))  ## Filters out any rows with missing values for ABV
State_ABV = aggregate(x = State_ABV$ABV,  ## Creates data set of all the states and their corresponding median ABV values
          by = list(State_ABV$State),
          FUN = median)
colnames(State_ABV)[which(names(State_ABV) == &quot;x&quot;)] &lt;- &quot;Median_ABV&quot;  ## Renames column to Median_ABV
colnames(State_ABV)[which(names(State_ABV) == &quot;Group.1&quot;)] &lt;- &quot;State&quot;  ## Renames column to State
State_ABV %&gt;% ggplot(aes(x=reorder(State, -Median_ABV), y=Median_ABV, color=State)) +  ## Graphs Median ABV by State in order
  geom_col() + ggtitle(&quot;Median ABV by State&quot;) + xlab(&quot;State&quot;) + ylab(&quot;Median ABV&quot;)  </code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>a = which.max(State_ABV$Median_ABV)  ## Finds and displays the state with the greatest median ABV
State_ABV[a,]</code></pre>
<pre><code>##   State Median_ABV
## 8    DC     0.0625</code></pre>
<pre class="r"><code>b = which.min(State_ABV$Median_ABV)  ## Finds and displays the state with the lowest median ABV
State_ABV[b,]</code></pre>
<pre><code>##    State Median_ABV
## 45    UT       0.04</code></pre>
<p>Code Summary: Finds and displays the beer with highest ABV and IBU values. Also finds and displays the beer with the lowest ABV and IBU values.</p>
<pre class="r"><code>c = which.max(imp_beer_comp$ABV)  ## Finds and displays beer with the highest ABV value
imp_beer_comp[c,]</code></pre>
<pre><code>##     Brewery_ID                                            Beer_Name Beer_ID
## 375         52 Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale    2565
##       ABV IBU            Style Ounces            Brewery_Name    City State
## 375 0.128  NA Quadrupel (Quad)   19.2 Upslope Brewing Company Boulder    CO</code></pre>
<pre class="r"><code>d = which.max(imp_beer_comp$IBU)  ## Finds and displays beer with the highest IBU value
imp_beer_comp[d,]</code></pre>
<pre><code>##      Brewery_ID                 Beer_Name Beer_ID   ABV IBU
## 1857        375 Bitter Bitch Imperial IPA     980 0.082 138
##                               Style Ounces            Brewery_Name    City
## 1857 American Double / Imperial IPA     12 Astoria Brewing Company Astoria
##      State
## 1857    OR</code></pre>
<pre class="r"><code>e = which.min(imp_beer_comp$ABV)  ## Finds and displays beer with the lowest ABV value
imp_beer_comp[c,]</code></pre>
<pre><code>##     Brewery_ID                                            Beer_Name Beer_ID
## 375         52 Lee Hill Series Vol. 5 - Belgian Style Quadrupel Ale    2565
##       ABV IBU            Style Ounces            Brewery_Name    City State
## 375 0.128  NA Quadrupel (Quad)   19.2 Upslope Brewing Company Boulder    CO</code></pre>
<pre class="r"><code>f = which.min(imp_beer_comp$IBU)  ## Finds and displays beer with the lowest IBU value
imp_beer_comp[d,]</code></pre>
<pre><code>##      Brewery_ID                 Beer_Name Beer_ID   ABV IBU
## 1857        375 Bitter Bitch Imperial IPA     980 0.082 138
##                               Style Ounces            Brewery_Name    City
## 1857 American Double / Imperial IPA     12 Astoria Brewing Company Astoria
##      State
## 1857    OR</code></pre>
<p>Code Summary: Summarizes the ABV value and plots ABV distribution by state.</p>
<pre class="r"><code>summary(imp_beer_comp$ABV)  ## Summarizes ABV data</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00100 0.05000 0.05600 0.05977 0.06700 0.12800      62</code></pre>
<pre class="r"><code>imp_beer_comp %&gt;% ggplot(aes(x=ABV, color=State)) + geom_histogram() + ggtitle(&quot;ABV Distribution&quot;) ## Histogram plot of ABV distribution</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>imp_beer_comp %&gt;% ggplot(aes(x=ABV, color=State)) + geom_histogram() +  ## Histogram plot of ABV distribution by state histogram
  facet_wrap(~State) + ggtitle(&quot;ABV Distribution by State&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code>imp_beer_comp %&gt;% ggplot(aes(x=State, y=ABV, color=State)) + geom_boxplot() + ggtitle(&quot;ABV Distribution by State&quot;)  ## Boxplot of ABV distribution by state</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<p>Code Summary: Plots the relationship between ABV and IBU</p>
<pre class="r"><code>imp_beer_comp %&gt;% ggplot(aes(x=ABV, y=IBU, color=State)) + geom_point() + ggtitle(&quot;ABV vs IBU&quot;)  ## Scatter plot comparing ABV and IBU (Points colored by state)</code></pre>
<pre><code>## Warning: Removed 1005 rows containing missing values (geom_point).</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>imp_beer_comp %&gt;% ggplot(aes(x=ABV, y=IBU)) + geom_point() + ggtitle(&quot;ABV vs IBU&quot;) + geom_smooth(method = &quot;lm&quot;) ## Scatter plot comparing ABV and IBU with a linear regression line</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 1005 rows containing non-finite values (stat_smooth).

## Warning: Removed 1005 rows containing missing values (geom_point).</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>Code Summary: Creates a data set of just IPA and Ale style of beers and plots this new data.</p>
<pre class="r"><code>IPA_Beer = imp_beer_comp %&gt;% filter(str_detect(imp_beer_comp$Style, &quot;IPA&quot;))  ## Creates data set of just IPA beers
IPA_Beer$Style = &quot;IPA&quot;
Ale_Beer = imp_beer_comp %&gt;% filter(str_detect(imp_beer_comp$Style, &quot;Ale&quot;))  ## Creates data set of just Ale beers
Ale_Beer$Style = &quot;Ale&quot;
IPA_Ale_Beer = rbind(IPA_Beer, Ale_Beer)  ## Combines the IPA and Ale beer data sets together
IPA_Ale_Beer = na.omit(IPA_Ale_Beer) ## Removes any missing values from the data set
IPA_Ale_Beer %&gt;% ggplot(aes(x=ABV, y=IBU, color=Style)) + geom_point() + ggtitle(&quot;ABV vs IBU&quot;) ## Scatter plot of IBU and ABV, style of Beers are colored</code></pre>
<p><img src="BeerStudy_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Code Summary: Splits the data into a training and test set. Runs a KNN classification model on the IPA and Ale beer data set.</p>
<pre class="r"><code>set.seed(1)  ## Sets the seed
sample = sample.split(IPA_Ale_Beer[,1], SplitRatio = .70)  ## Splits the data using 30/70 ratio
beer_train = subset(IPA_Ale_Beer, sample == TRUE)  ## Creates training set
beer_test  = subset(IPA_Ale_Beer, sample == FALSE)  ## Creates test set
v1 = beer_train[,6]  ## Creates classifiers references of IBA and IBU
pred = knn(beer_train[,c(&#39;ABV&#39;, &#39;IBU&#39;)], beer_test[,c(&#39;ABV&#39;, &#39;IBU&#39;)], v1, k=2, prob = TRUE)  ## Creates data set of predictions using the KNN model for the style of beers (IPA vs Ale)
actual = beer_test$Style  ## Creates data set of the actual style of the beers
confusionMatrix(pred,as.factor(actual))  ## Creates a confusion matrix of the predicted and actual style of the beers</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Ale IPA
##        Ale 148  20
##        IPA  26  80
##                                           
##                Accuracy : 0.8321          
##                  95% CI : (0.7825, 0.8744)
##     No Information Rate : 0.635           
##     P-Value [Acc &gt; NIR] : 5.515e-13       
##                                           
##                   Kappa : 0.6424          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.461           
##                                           
##             Sensitivity : 0.8506          
##             Specificity : 0.8000          
##          Pos Pred Value : 0.8810          
##          Neg Pred Value : 0.7547          
##              Prevalence : 0.6350          
##          Detection Rate : 0.5401          
##    Detection Prevalence : 0.6131          
##       Balanced Accuracy : 0.8253          
##                                           
##        &#39;Positive&#39; Class : Ale             
## </code></pre>
<p>Code Summary: Runs an ANOVA and Tukey test to determine which States have significant difference in ABV.</p>
<pre class="r"><code>anova_beer = imp_beer_comp %&gt;% filter(!is.na(imp_beer_comp$ABV))  ## Filters out all NA values in ABV
anova_results = aov(ABV ~ State, data = anova_beer)  ## ANOVA test for ABV between all States
summary(anova_results)  ## Summarizes the ANOVA results (results are significant)</code></pre>
<pre><code>##               Df Sum Sq   Mean Sq F value   Pr(&gt;F)    
## State         50 0.0218 0.0004359   2.451 9.07e-08 ***
## Residuals   2297 0.4086 0.0001779                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>HSD_results&lt;-HSD.test(anova_results,&quot;State&quot;, group=FALSE)  ## Runs Tukey pairwise comparison test
state_comparison = HSD_results$comparison  ## Makes data set related to comparisons including pvalues
sign_comp = filter(state_comparison, pvalue &lt;= .05)  ## Makes data set of only comparison at are significant (pvalues &lt;= 0.5)
print(sign_comp)  ## Prints all significant comparisons</code></pre>
<pre><code>##             difference pvalue signif.           LCL           UCL
##  CA -  WI  0.007023594 0.0498       *  2.080796e-06  0.0140451073
##  CO -  MA  0.007689073 0.0063      **  8.874533e-04  0.0144906931
##  CO -  OR  0.006308000 0.0153       *  4.532161e-04  0.0121627839
##  CO -  UT  0.011487385 0.0264       *  4.740684e-04  0.0225007008
##  CO -  WI  0.009313176 0.0000     ***  2.602548e-03  0.0160238047
##  IN -  MA  0.007711234 0.0306       *  2.488927e-04  0.0151735748
##  IN -  UT  0.011509545 0.0454       *  7.636388e-05  0.0229427265
##  IN -  WI  0.009335337 0.0005     ***  1.955836e-03  0.0167148379
##  MA -  MI -0.007694557 0.0239       * -1.502622e-02 -0.0003628883
##  MI -  UT  0.011492868 0.0416       *  1.445439e-04  0.0228411922
##  MI -  WI  0.009318660 0.0003     ***  2.071325e-03  0.0165659945</code></pre>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
